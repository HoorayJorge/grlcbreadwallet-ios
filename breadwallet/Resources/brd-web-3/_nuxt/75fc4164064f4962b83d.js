(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1132:function(e,t,r){"use strict";r.r(t);r(26),r(38),r(41),r(42);var n=r(3),a=r.n(n),o=(r(12),r(1)),s=r.n(o),i=r(11),c=r(2),u=r(14),m=r(97),f=r(473),l=r(81),p={components:{ServiceScreen:f.a,ToolbarButton:l.a},data:function(){return{quotes:null,serviceScreen:null,error:null}},mounted:function(){var e=s()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.quoteMeta.length){e.next=3;break}return e.next=3,this.$store.dispatch("exchange/update",{mode:this.mode});case 3:return e.next=5,this.fetchQuotes();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),computed:{mode:function(){return this.$route.params.mode||"buy"},quoteMeta:function(){return this.$store.getters["exchange/quoteMeta"]({amount:this.amount,destination:this.to,source:this.from,mode:this.mode})},paymentMethod:function(){return this.$store.state["partner-selector"].paymentMethod},store:function(){return this.$store.state.exchange[this.mode]},to:function(){return this.store.destination},from:function(){return this.store.source},amount:{get:function(){return this.store.amount},set:function(e){this.$store.commit("exchange/amount",{mode:this.mode,value:e})}},fiatAmount:function(){if(this.quoteMeta.length&&this.quoteMeta[0].fiat)return this.quoteMeta[0].fiat.amount},cryptoAmount:function(){if(this.quoteMeta.length&&this.quoteMeta[0].crypto)return this.quoteMeta[0].crypto.amount}},methods:{browser:u.b,receiveAmount:function(e){return"buy"===this.mode||"sell"===this.mode?e.crypto&&e.crypto.amount:"trade"===this.mode?e.meta&&e.meta.to:void 0},receiveAmountConverted:function(e){return"trade"===this.mode?e.meta&&"".concat(i.a.currencyToString(e.meta.cryptoReceiveAmount,{precision:4})," ").concat(e.meta.cryptoReceiveAmount.currency.toUpperCase()):e.fiat&&e.fiat.amount},sendAmount:function(e){return"buy"===this.mode||"sell"===this.mode?e.meta&&e.meta.fiatAmount:"trade"===this.mode?e.meta&&e.meta.from:void 0},fetchQuotes:function(){var e=s()(regeneratorRuntime.mark(function e(){var t,r,n,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},r=(r=t.serviceToken)||null,this.error=null,e.next=5,this.$store.dispatch("exchange/fetchQuotes",{mode:this.mode,serviceToken:r});case 5:(n=e.sent).length||(this.error={message:this.$t("buy.quote.error")}),this.quotes=this.quoteFilter(n);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),partnerName:function(e){return Object(c.q)(e)},currencyString:function(e,t){if(!(e=e||t))return"";var r="".concat(i.a.symbolFor(e)),n=!r&&" ".concat(e.currency)||"";return"".concat(r).concat(i.a.currencyToString(e,{precision:8})).concat(n)},limitMessage:function(e){var t,r=e.bound;e.amount,e.currency;return"buy"===this.mode&&(t="source"),"sell"===this.mode&&(t="destination"),"trade"===this.mode&&(t="trade"),this.$t("exchange.".concat(t,".paragraph.").concat(r))},validate:function(){var e=s()(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("exchange/validate".concat(t.action),t.value);case 2:if(r=e.sent,n=r.response,r.result,r.error,"confirm"!=t.action){e.next=15;break}if(e.t0=200==n.status,!e.t0){e.next=13;break}return e.next=11,n.text();case 11:e.t1=e.sent,e.t0="email confirmed"==e.t1;case 13:if(!e.t0){e.next=15;break}t.context.validated=!0;case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleAction:function(){var e=s()(regeneratorRuntime.mark(function e(t,r){var n,o,s,i,u,f,l,p,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.action,o=t.partner){e.next=3;break}return e.abrupt("return",console.error("partner required to handle action"));case 3:if(n.method&&this.$event("exchange.new-quote.".concat(this.actionEvent(n)),{serviceName:o,mode:this.mode,paymentMethod:this.paymentMethod,amount:this.currencyString(this.cryptoAmount)}),this.quotes&&(s=this.quotes[r],this.quotes=null),"refresh"!=n.type){e.next=9;break}return e.next=8,this.fetchQuotes();case 8:return e.abrupt("return",e.sent);case 9:if("set-amount"!=n.type&&"quote"!=n.type){e.next=13;break}return i=Object(c.g)(n,"params.amount")||n.value,this.amount=i,e.abrupt("return");case 13:return e.next=15,Object(m.b)(o);case 15:return u=e.sent,e.next=18,u.performAction(n);case 18:if(f=e.sent,l=f.result,(p=f.error)&&(this.error=p),l){e.next=24;break}return e.abrupt("return");case 24:if(!(h=Object(c.g)(l,"serviceToken"))){e.next=28;break}return e.next=28,this.$kv.set("".concat(o,"ServiceToken"),h);case 28:if("state-change"!=l.type){e.next=31;break}return e.next=31,this.fetchQuotes({serviceToken:h});case 31:if(!(d=Object(c.g)(l,"meta.screen")||"screen"==l.type&&l||null)){e.next=37;break}if("complete"!=d.screenType){e.next=36;break}return this.serviceScreen=d,e.abrupt("return");case 36:this.quotes=[a()({},s,{meta:l})];case 37:"navigate"==l.type&&this.$nuxt.$router.push(l.url),s&&!this.quotes&&(this.quotes=[s]);case 39:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),actionEvent:function(e){var t=e.method&&e.method.split("/")||[];return(t=t[1]||t[0])||e.type},goToPartner:function(e){this.$router.push("/exchange/".concat(this.mode,"/services/").concat(e))},screen:function(e){return"screen"==e.type?e:e.meta&&e.meta.screen?e.meta.screen:null},execute:function(){var e=s()(regeneratorRuntime.mark(function e(t,r){var n,a,o,s,i,c,u,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.partner,a=t.execute){e.next=3;break}return e.abrupt("return");case 3:if(o=["flow","rpc","blockchain-tx"].includes(a.type),s=o?"reroute":"execute",this.$event("exchange.new-quote.".concat(s),{serviceName:n,mode:this.mode,paymentMethod:this.paymentMethod,amount:this.currencyString(this.cryptoAmount)}),!o){e.next=8;break}return e.abrupt("return",this.goToPartner(n));case 8:return e.next=10,Object(m.b)(n);case 10:return i=e.sent,e.next=13,i.performAction(a);case 13:c=e.sent,u=c.result,(f=c.error)&&(this.error=f),this.serviceScreen=this.screen(u);case 18:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),quoteFilter:function(e){if(new Date>=new Date("01 Feb 2021 00:00:00 GMT"))return e;var t=e.find(function(e){return"moonpay"===e.partner});return t&&this.$store.state.experiments.all["moonpay-only"]?[t]:e}},watch:{amount:function(e){this.fetchQuotes()}}},h=(r(626),r(0)),d=Object(h.a)(p,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("content-screen",{attrs:{mode:"page"}},[r("checkpoint",{attrs:{name:"exchange.quotes",args:{mode:e.mode,to:e.to,from:e.from,amountTo:e.currencyString(e.cryptoAmount),paymentMethod:e.paymentMethod}}}),e._v(" "),r("portal",{attrs:{to:"toolbar-button-left"}},["buy"===e.mode?r("toolbar-button",{staticClass:"back",on:{click:function(t){e.$router.push("/exchange/"+e.mode+"/payment-method")}}},[r("icon",{attrs:{name:"arrow-left"}}),e._v(" "+e._s(e.$t("exchange.payment-method.type."+e.paymentMethod)||"")+"\n      ")],1):"trade"===e.mode?r("toolbar-button",{staticClass:"back",on:{click:function(t){e.$router.push("/exchange/"+e.mode)}}},[r("icon",{attrs:{name:"arrow-left"}}),e._v(" "),r("butter-currency",{attrs:{value:e.amount,trim:!0,precision:4}})],1):e._e()],1),e._v(" "),r("portal",{attrs:{slim:"",to:"mobile-title",transition:{name:"fast-fade",mode:"out-in"}}},[r("span",[e._v(e._s(e._f("titlecase")(e.mode)))])]),e._v(" "),e.quotes&&e.quotes.length&&!e.error?r("h1",[e._v("Offers")]):e._e(),e._v(" "),e.serviceScreen?r("service-screen",{attrs:{screen:e.serviceScreen},on:{action:e.handleAction}}):r("loader",{staticClass:"loader",attrs:{data:e.quotes,error:e.error}},[e._l(e.quotes,function(t,n){return r("partner-quote",{key:n,staticClass:"quotes",attrs:{receiveAmount:e.receiveAmount(t),receiveAmountConverted:e.receiveAmountConverted(t),sendAmount:e.sendAmount(t),fee:t.meta&&t.meta.fee,delivery:t.meta&&t.meta.delivery,name:e.partnerName(t.partner),to:e.to,from:e.from,settings:t.settings,note:t.meta&&t.meta.note,promotions:t.meta&&t.meta.promotions},on:{settings:e.browser},nativeOn:{click:function(r){e.execute(t,n)}}},[t.error?r("partner-message",{attrs:{title:t.error.title,message:t.error.message}}):t.meta&&"screen"==t.meta.type?r("partner-message",{attrs:{title:t.meta.title,message:t.meta.message,form:t.meta.form||[],userActions:t.meta.userActions,partner:t.partner,expires:t.expires},on:{action:function(t){e.handleAction(t,n)},validate:e.validate}}):"limit"==t.type?r("partner-message",{attrs:{title:e.$t("exchange.source.title."+t.bound),message:e.limitMessage(t),userActions:t.userActions,partner:t.partner,limit:t.fiat&&t.fiat[t.bound]||t.crypto&&t.crypto[t.bound]},on:{action:e.handleAction}}):"iframe"==t.type?r("partner-message",{attrs:{title:t.meta.title,partner:t.partner,userActions:t.userActions},on:{action:e.handleAction}}):"screen"==t.type?r("partner-message",{attrs:{title:t.title,message:t.message,userActions:t.userActions,partner:t.partner,expires:t.expires},on:{action:e.handleAction}}):"flow"==t.type?r("partner-message",{attrs:{title:t.title,message:t.message,userActions:t.userActions,partner:t.partner},on:{action:e.handleAction}}):t.meta?e._e():r("partner-message",{attrs:{title:"Fetching quote..."}})],1)}),e._v(" "),r("partner-message",{attrs:{slot:"empty",title:"Communicating with our partners..."},slot:"empty"})],2)],1)},[],!1,null,"846616ea",null);d.options.__file="quotes.vue";t.default=d.exports},455:function(e,t,r){var n=r(467);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(7).default)("c3fc143a",n,!0,{})},461:function(e,t,r){"use strict";var n=r(3),a=r.n(n);r(28);t.a={props:["width","height","src","rootElement"],functional:!0,render:function(e,t){var r={height:t.props.height,width:t.props.width},n=t.props.src;return e(t.props.rootElement||"svg",{attrs:a()({},n&&n.$,r)},function e(t,r){if(!r)return[];var n=[];if("string"!=typeof r&&"_"in r)return r._;for(var o in r)if(o.match(/^\d+$/))n.push(r[o]);else if("$"!==o&&"_"!==o)for(var s in r[o]){var i=r[o][s],c=a()({},i&&i.$);n.push(t(o,{attrs:c},e(t,i)))}return n}(e,n).concat(t.children||[]))}}},466:function(e,t,r){"use strict";var n=r(455);r.n(n).a},467:function(e,t,r){var n=r(17);(e.exports=r(6)(!1)).push([e.i,"@font-face{font-family:Circular-Pro-Book;src:url("+n(r(8))+");src:url("+n(r(8))+'?#iefix) format("embedded-opentype"),url('+n(r(18))+') format("woff2"),url('+n(r(19))+') format("woff");font-weight:400;font-style:normal}@font-face{font-family:Circular-Pro-Bold;src:url('+n(r(9))+");src:url("+n(r(9))+'?#iefix) format("embedded-opentype"),url('+n(r(20))+') format("woff2"),url('+n(r(21))+') format("woff");font-weight:400;font-style:normal}@-webkit-keyframes autofill-data-v-1f09f9d7{to{color:#666;background:transparent}}.svg-header[data-v-1f09f9d7]{width:50%;max-width:132px}.shield[data-v-1f09f9d7]{width:98px;height:108px;display:block}.limit[data-v-1f09f9d7]{margin:40px auto 0;width:200px;height:118px;align-self:center}.checkmark[data-v-1f09f9d7]{width:71px;height:50px}.checkmark svg[data-v-1f09f9d7]{fill:none}.cross[data-v-1f09f9d7]{width:71px;height:71px}.exchange[data-v-1f09f9d7]{width:165px;height:75px}.exchange svg[data-v-1f09f9d7]{fill:none}h1[data-v-1f09f9d7]{font:24px/32px Circular-Pro-Book,Roboto,BlinkMacSystemFont,-apple-system,Segoe UI,sans-serif;margin-top:20px}.message[data-v-1f09f9d7]{padding:40px}.info .message[data-v-1f09f9d7]{font-size:14px;line-height:20px;padding:0}.loading-wrapper[data-v-1f09f9d7]{background:#5b6dee;border-radius:50%;width:160px;height:160px;margin:40px auto;position:relative;display:flex;justify-content:center;align-items:center;font-size:24px}.loading-wrapper span[data-v-1f09f9d7]{margin:0 10px}.complete .checkmark[data-v-1f09f9d7]{width:144px;height:144px}',""])},473:function(e,t,r){"use strict";r(12);var n=r(1),a=r.n(n),o=r(3),s=r.n(o),i=(r(27),r(15)),c=r(14),u=r(461),m={props:{screen:{type:Object},click:{type:Function}},components:{InlineSvg:u.a},watch:{screen:{immediate:!0,deep:!0,handler:function(){var e=this.screen&&this.screen.event;e&&this.$event(e.name,s()({},e.args))}}},methods:{handler:function(){var e=a()(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$emit(i.b,t),this.$emit(i.e,t),this.$emit("action",{action:t,partner:this.screen.partner});try{t.event&&this.$event(t.event.name,s()({},t.event.args))}catch(e){this.$report(e)}if(r=!1,"function"!=typeof this.click){e.next=10;break}return e.next=8,this.click(t);case 8:e.t0=e.sent,r=!1!==e.t0;case 10:if(!r){e.next=13;break}e.next=27;break;case 13:if("browser-url"!=t.type){e.next=18;break}return e.next=16,Object(c.b)(t);case 16:e.next=27;break;case 18:if("navigate"!=t.type){e.next=22;break}this.$router.push(t.url),e.next=27;break;case 22:if("close"!=t.type){e.next=26;break}Object(c.c)(),e.next=27;break;case 26:throw new Error('ServiceScreen Unsupported Action Type "'.concat(t.type,'"'));case 27:this.$emit(i.a,t);case 28:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},f=(r(466),r(0)),l=Object(f.a)(m,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("content-screen",{attrs:{scroll:!1}},[r("div",{class:e.screen.screenType,attrs:{slot:"graphic"},slot:"graphic"},["loading"==e.screen.screenType?r("loading-dots",{staticClass:"loading-dots"}):e._e(),e._v(" "),"svg-header"==e.screen.screenType?r("inline-svg",{attrs:{src:e.screen.svg}}):e._e(),e._v(" "),"complete"==e.screen.screenType?r("icon",{staticClass:"checkmark",attrs:{name:"checkmark-alt"}}):e._e(),e._v(" "),"shield"==e.screen.screenType?r("icon",{staticClass:"shield",attrs:{name:"shield"}}):e._e(),e._v(" "),"exchange"==e.screen.screenType?r("icon",{staticClass:"exchange",attrs:{name:"exchange"}}):e._e(),e._v(" "),"error"==e.screen.screenType?r("icon",{staticClass:"cross",attrs:{name:"cross"}}):e._e()],1),e._v(" "),e.screen.title?r("h1",[e._v(e._s(e.screen.title))]):e._e(),e._v(" "),e.screen.message?r("div",{staticClass:"message",domProps:{innerHTML:e._s(e.screen.message)}}):e._e(),e._v(" "),e._l(e.screen.userActions,function(t,n){return r("div",{key:n,attrs:{slot:"actions"},slot:"actions"},[r("butter-button",{attrs:{secondary:"secondary"==t.style,disabled:t.require&&!t.validated},on:{click:function(r){if(r.target!==r.currentTarget)return null;e.handler(t)}}},[e._v(e._s(t.title))])],1)})],2)},[],!1,null,"1f09f9d7",null);l.options.__file="ServiceScreen.vue";t.a=l.exports},504:function(e,t,r){var n=r(627);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r(7).default)("4addbfc3",n,!0,{})},626:function(e,t,r){"use strict";var n=r(504);r.n(n).a},627:function(e,t,r){var n=r(17);(e.exports=r(6)(!1)).push([e.i,"@font-face{font-family:Circular-Pro-Book;src:url("+n(r(39))+");src:url("+n(r(39))+'?#iefix) format("embedded-opentype"),url('+n(r(72))+') format("woff2"),url('+n(r(73))+') format("woff");font-weight:400;font-style:normal}@font-face{font-family:Circular-Pro-Bold;src:url('+n(r(40))+");src:url("+n(r(40))+'?#iefix) format("embedded-opentype"),url('+n(r(74))+') format("woff2"),url('+n(r(75))+') format("woff");font-weight:400;font-style:normal}#__layout[data-v-846616ea],#__nuxt[data-v-846616ea],html[data-v-846616ea]{min-height:100%}html[data-v-846616ea]{height:100%;position:relative}body[data-v-846616ea]{background-color:#141233;color:#fff;font:16px/24px Circular-Pro-Book,serif}p[data-v-846616ea]{margin-top:0;margin-bottom:16px}h1[data-v-846616ea]{font:32px/40px Circular-Pro-Bold,serif;padding:0 16px;margin:0}h2[data-v-846616ea],h3[data-v-846616ea]{font:28px/40px Circular-Pro-Book,serif}b[data-v-846616ea]{font:Circular-Pro-Bold,serif}a[data-v-846616ea]{color:#29abe2;text-decoration:none}h1[data-v-846616ea]{margin:0 0 8px}.loader[data-v-846616ea],.quotes[data-v-846616ea]{display:flex;flex-direction:column}.loader[data-v-846616ea]{flex-shrink:0;height:100%}.back[data-v-846616ea]{display:flex;align-items:center}.back .icon[data-v-846616ea]{margin-right:8px}',""])}}]);
//# sourceMappingURL=75fc4164064f4962b83d.js.map